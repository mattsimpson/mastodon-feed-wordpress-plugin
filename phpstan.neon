includes:
    - vendor/szepeviktor/phpstan-wordpress/extension.neon

parameters:
    level: 6
    inferPrivatePropertyTypeFromConstructor: true

    paths:
        - mastodon-feed.php

    bootstrapFiles:
        - tests/phpstan-bootstrap.php

    excludePaths:
        - tests/*
        - vendor/*
        - node_modules/*
        - build/*
        - src/*
        - dist/*
        - scripts/*

    ignoreErrors:
        # WordPress core functions are dynamically loaded
        - '#Function (add_action|add_filter|add_shortcode|register_block_type|get_option|update_option|delete_option|wp_remote_get|wp_kses_post|esc_html|esc_attr|esc_url) not found#'
        # Ignore isset() checks on known array keys (false positive)
        - '#Offset .* on array.* in isset\(\) always exists and is not nullable#'
        # Allow sanitize callbacks as strings (WordPress pattern)
        - '#Parameter \#3 \$args of function register_setting expects array.*given#'
        # WordPress hooks/callbacks don't require return types when returning void
        - '#Function IncludeMastodonFeedPlugin\\.* has no return type specified\.#'
        # WordPress function parameters with arrays don't always need array value types specified
        - '#Function IncludeMastodonFeedPlugin\\.*has parameter \$.*with no value type specified in iterable type array#'
        # WordPress REST API return types can be generic arrays
        - '#Function IncludeMastodonFeedPlugin\\(fetch_and_cache_posts|mastodon_feed_do_account_lookup|mastodon_feed_handle_lookup)\(\) return type has no value type specified in iterable type array#'
        # WordPress REST API generic types don't need specification
        - '#Function IncludeMastodonFeedPlugin\\lookup_mastodon_account\(\) has parameter \$request with generic class WP_REST_Request but does not specify its types#'
        # Ternary operators for default values with get_option are acceptable patterns
        - '#Ternary operator condition is always (true|false)\.#'
